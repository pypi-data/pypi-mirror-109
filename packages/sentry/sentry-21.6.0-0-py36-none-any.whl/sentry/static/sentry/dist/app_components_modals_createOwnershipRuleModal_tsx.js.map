{"version":3,"sources":["webpack:///./app/views/settings/project/projectOwnership/modal.tsx","webpack:///./app/components/modals/createOwnershipRuleModal.tsx","webpack:///../node_modules/lodash/uniq.js"],"names":["this","props","organization","project","issueId","slug","allowError","error","status","state","ownership","urlTagData","eventData","urls","topValues","sort","a","b","count","map","i","value","slice","entry","entries","find","type","includes","frames","data","values","stacktrace","inAppFrames","filter","frame","inApp","length","paths","uniq","filename","absPath","Fragment","t","initialText","raw","AsyncComponent","CreateOwnershipRuleModal","Body","Header","closeModal","closeButton","onSave","onClose","window","setTimeout","modalCss","css","theme","baseUniq","module","exports","array"],"mappings":"k3FAmGA,Q,8iBAnEE,WAA2D,MAChBA,KAAKC,MAAvCC,EADkD,EAClDA,aAAcC,EADoC,EACpCA,QAASC,EAD2B,EAC3BA,QAC9B,MAAO,CACL,CAAC,YAAD,oBAA2BF,EAAaG,KAAxC,YAAgDF,EAAQE,KAAxD,gBACA,CACE,aADF,kBAEaD,EAFb,cAGE,GACA,CACEE,WAAY,SAAAC,GAAK,OAEE,MAAjBA,EAAMC,UAGZ,CAAC,YAAD,kBAAyBJ,EAAzB,uB,wBAIJ,WAAa,MACgCJ,KAAKS,MAAzCC,EADI,EACJA,UAAWC,EADP,EACOA,WAAYC,EADnB,EACmBA,UAC9B,IAAKF,IAAcC,IAAeC,EAChC,OAAO,KAET,IAaiC,UAGC,IAhB5BC,EAAOF,EACTA,EAAWG,UACRC,MAAK,SAACC,EAAGC,GAAJ,OAAUD,EAAEE,MAAQD,EAAEC,SAC3BC,KAAI,SAAAC,GAAC,OAAIA,EAAEC,SACXC,MAAM,EAAG,GACZ,GAGEC,GAASX,aAAD,EAACA,EAAWY,SAAoBC,MAAK,gBAAEC,EAAF,EAAEA,KAAF,MACjD,CAAC,YAAa,cAAcC,SAASD,MAGnCE,EAAkB,GACF,eAAhBL,aAAA,EAAAA,EAAOG,QACTE,EAAM,UAAGL,SAAH,UAAGA,EAAOM,YAAV,iBAAG,EAAaC,cAAhB,iBAAG,EAAsB,UAAzB,iBAAG,EAA0BC,kBAA7B,aAAG,EAAsCH,cAAzC,QAAmD,IAEvC,gBAAhBL,aAAA,EAAAA,EAAOG,QACTE,EAAM,UAAGL,SAAH,UAAGA,EAAOM,YAAV,aAAG,EAAaD,cAAhB,QAA0B,IAIlC,IAAMI,EAAcJ,EAAOK,QAAO,SAAAC,GAAK,OAAIA,EAAMC,SAC7CH,EAAYI,OAAS,IACvBR,EAASI,GAGX,IAAMK,EAAQC,IAAKV,EAAOT,KAAI,SAAAe,GAAK,OAAIA,EAAMK,UAAYL,EAAMM,SAAW,OACvEP,QAAO,SAAAb,GAAC,OAAIA,KACZE,MAAM,EAAG,IAEZ,OACE,QAAC,EAAAmB,SAAD,YACE,uBAAIC,OAAE,iEACN,QAAC,IAAD,OACM1C,KAAKC,OADX,IAEE0C,aAAajC,aAAA,EAAAA,EAAWkC,MAAO,GAC/B/B,KAAMA,EACNwB,MAAOA,Y,GA7DmBQ,K,qkBClBpC,IAAMC,EAA2B,SAAC,GAAgD,IAA/CC,EAA+C,EAA/CA,KAAMC,EAAyC,EAAzCA,OAAQC,EAAiC,EAAjCA,WAAehD,GAAkB,yCAMhF,OACE,QAAC,EAAAwC,SAAD,YACE,QAACO,EAAD,CAAQE,aAAW,EAAnB,UAAqBR,OAAE,4BACvB,QAACK,EAAD,WACE,QAAC,EAAD,OAA2B9C,GAA3B,IAAkCkD,OATlB,WAAM,MAC1B,UAAAlD,EAAMmD,eAAN,cAAAnD,GACAoD,OAAOC,WAAWL,EAAY,eAH5BH,E,uCAgBC,IAAMS,GAAWC,QAAH,sBACEC,oBADF,wDASrB,W,2CCtCA,IAAIC,EAAW,EAAQ,uCAwBvBC,EAAOC,QAJP,SAAcC,GACZ,OAAQA,GAASA,EAAMzB,OAAUsB,EAASG,GAAS","file":"app_components_modals_createOwnershipRuleModal_tsx.b1cccdb527f87e93c90d.js","sourcesContent":["import {Fragment} from 'react';\nimport uniq from 'lodash/uniq';\n\nimport AsyncComponent from 'app/components/asyncComponent';\nimport {t} from 'app/locale';\nimport {Frame, Organization, Project, TagWithTopValues} from 'app/types';\nimport {Entry, EventError} from 'app/types/event';\nimport OwnerInput from 'app/views/settings/project/projectOwnership/ownerInput';\n\ntype IssueOwnershipResponse = {\n  raw: string;\n  fallthrough: boolean;\n  dateCreated: string;\n  lastUpdated: string;\n  isActive: boolean;\n  autoAssignment: boolean;\n};\n\ntype Props = AsyncComponent['props'] & {\n  organization: Organization;\n  project: Project;\n  issueId: string;\n  onSave: () => void;\n};\n\ntype State = {\n  ownership: null | IssueOwnershipResponse;\n  eventData: null | EventError;\n  urlTagData: null | TagWithTopValues;\n} & AsyncComponent['state'];\n\nclass ProjectOwnershipModal extends AsyncComponent<Props, State> {\n  getEndpoints(): ReturnType<AsyncComponent['getEndpoints']> {\n    const {organization, project, issueId} = this.props;\n    return [\n      ['ownership', `/projects/${organization.slug}/${project.slug}/ownership/`],\n      [\n        'urlTagData',\n        `/issues/${issueId}/tags/url/`,\n        {},\n        {\n          allowError: error =>\n            // Allow for 404s\n            error.status === 404,\n        },\n      ],\n      ['eventData', `/issues/${issueId}/events/latest/`],\n    ];\n  }\n\n  renderBody() {\n    const {ownership, urlTagData, eventData} = this.state;\n    if (!ownership && !urlTagData && !eventData) {\n      return null;\n    }\n    const urls = urlTagData\n      ? urlTagData.topValues\n          .sort((a, b) => a.count - b.count)\n          .map(i => i.value)\n          .slice(0, 5)\n      : [];\n\n    // pull frame data out of exception or the stacktrace\n    const entry = (eventData?.entries as Entry[]).find(({type}) =>\n      ['exception', 'stacktrace'].includes(type)\n    );\n\n    let frames: Frame[] = [];\n    if (entry?.type === 'exception') {\n      frames = entry?.data?.values?.[0]?.stacktrace?.frames ?? [];\n    }\n    if (entry?.type === 'stacktrace') {\n      frames = entry?.data?.frames ?? [];\n    }\n\n    // filter frames by inApp unless there would be 0\n    const inAppFrames = frames.filter(frame => frame.inApp);\n    if (inAppFrames.length > 0) {\n      frames = inAppFrames;\n    }\n\n    const paths = uniq(frames.map(frame => frame.filename || frame.absPath || ''))\n      .filter(i => i)\n      .slice(0, 30);\n\n    return (\n      <Fragment>\n        <p>{t('Match against Issue Data: (globbing syntax *, ? supported)')}</p>\n        <OwnerInput\n          {...this.props}\n          initialText={ownership?.raw || ''}\n          urls={urls}\n          paths={paths}\n        />\n      </Fragment>\n    );\n  }\n}\n\nexport default ProjectOwnershipModal;\n","import {Fragment} from 'react';\nimport {css} from '@emotion/react';\n\nimport {ModalRenderProps} from 'app/actionCreators/modal';\nimport {t} from 'app/locale';\nimport theme from 'app/utils/theme';\nimport ProjectOwnershipModal from 'app/views/settings/project/projectOwnership/modal';\n\ntype Props = ModalRenderProps &\n  Pick<ProjectOwnershipModal['props'], 'organization' | 'project' | 'issueId'> & {\n    onClose?: () => void;\n  };\n\nconst CreateOwnershipRuleModal = ({Body, Header, closeModal, ...props}: Props) => {\n  const handleSuccess = () => {\n    props.onClose?.();\n    window.setTimeout(closeModal, 2000);\n  };\n\n  return (\n    <Fragment>\n      <Header closeButton>{t('Create Ownership Rule')}</Header>\n      <Body>\n        <ProjectOwnershipModal {...props} onSave={handleSuccess} />\n      </Body>\n    </Fragment>\n  );\n};\n\nexport const modalCss = css`\n  @media (min-width: ${theme.breakpoints[0]}) {\n    width: 80%;\n  }\n  [role='document'] {\n    overflow: initial;\n  }\n`;\n\nexport default CreateOwnershipRuleModal;\n","var baseUniq = require('./_baseUniq');\n\n/**\n * Creates a duplicate-free version of an array, using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons, in which only the first occurrence of each element\n * is kept. The order of result values is determined by the order they occur\n * in the array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * _.uniq([2, 1, 2]);\n * // => [2, 1]\n */\nfunction uniq(array) {\n  return (array && array.length) ? baseUniq(array) : [];\n}\n\nmodule.exports = uniq;\n"],"sourceRoot":""}