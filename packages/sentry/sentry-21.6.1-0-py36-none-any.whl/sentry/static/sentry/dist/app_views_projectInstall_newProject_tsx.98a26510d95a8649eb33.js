(self.webpackChunk=self.webpackChunk||[]).push([["app_views_projectInstall_newProject_tsx"],{"./app/utils/slugify.tsx":(e,t,r)=>{"use strict";function n(e){return"string"==typeof e?e.toLowerCase().replace(" ","-"):""}r.d(t,{Z:()=>n}),r("../node_modules/core-js/modules/es.regexp.exec.js"),r("../node_modules/core-js/modules/es.string.replace.js")},"./app/views/projectInstall/newProject.tsx":(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Se});var n,o,s,a=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=r("../node_modules/react-document-title/index.js"),c=r.n(i),l=r("./app/styles/space.tsx"),u=(r("../node_modules/core-js/modules/es.reflect.construct.js"),r("../node_modules/core-js/modules/es.object.keys.js"),r("../node_modules/core-js/modules/es.symbol.js"),r("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),r("../node_modules/core-js/modules/es.array.for-each.js"),r("../node_modules/core-js/modules/web.dom-collections.for-each.js"),r("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),r("../node_modules/core-js/modules/es.object.define-properties.js"),r("../node_modules/core-js/modules/es.object.define-property.js"),r("../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js")),d=r("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),p=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),m=r("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),f=r("../node_modules/@babel/runtime/helpers/esm/inherits.js"),h=r("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),g=r("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),v=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),j=r("../node_modules/@babel/runtime/regenerator/index.js"),y=r.n(j),b=(r("../node_modules/core-js/modules/es.array.find.js"),r("../node_modules/core-js/modules/es.function.name.js"),r("../node_modules/core-js/modules/es.array.concat.js"),r("../node_modules/core-js/modules/es.array.filter.js"),r("../node_modules/core-js/modules/es.array.map.js"),r("../node_modules/core-js/modules/es.array.every.js"),r("../node_modules/react/index.js")),Z=r("../node_modules/react-router/es/index.js"),_=r("../node_modules/@sentry/minimal/esm/index.js"),S=r("../node_modules/platformicons/build/index.js"),E=r("./app/actionCreators/modal.tsx"),x=r("./app/actions/projectActions.tsx"),R=r("./app/components/alert.tsx"),C=r("./app/components/button.tsx"),O=r("./app/components/forms/selectControl.tsx"),w=r("./app/components/pageHeading.tsx"),P=r("./app/components/platformPicker.tsx"),A=r("./app/components/tooltip.tsx"),T=r("./app/data/platformCategories.tsx"),k=r("./app/icons/index.tsx"),U=r("./app/locale.tsx"),L=r("./app/styles/input.tsx"),N=r("./app/utils/analytics.tsx"),I=r("./app/utils/getPlatformName.tsx"),D=r("./app/utils/slugify.tsx"),q=r("./app/utils/withApi.tsx"),F=r("./app/utils/withOrganization.tsx"),B=r("./app/utils/withTeams.tsx"),M=r("../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),z=r("../node_modules/@babel/runtime/helpers/esm/get.js"),X=(r("../node_modules/core-js/modules/es.array.reduce.js"),r("../node_modules/core-js/modules/es.date.to-string.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.regexp.to-string.js"),r("../node_modules/core-js/modules/es.array.some.js"),r("../node_modules/core-js/modules/es.parse-int.js"),r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/core-js/modules/es.string.includes.js"),r("../node_modules/core-js/modules/es.object.values.js"),r("../node_modules/lodash/isEqual.js")),V=r.n(X),Y=r("./app/components/asyncComponent.tsx"),G=r("./app/views/settings/components/forms/controls/input.tsx"),$=r("./app/views/settings/components/forms/controls/radioGroup.tsx"),H=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(Object(r),!0).forEach((function(t){(0,v.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e[e.ERRORS=0]="ERRORS",e[e.USERS=1]="USERS"}(o||(o={})),function(e){e[e.ALERT_ON_EVERY_ISSUE=0]="ALERT_ON_EVERY_ISSUE",e[e.CUSTOMIZED_ALERTS=1]="CUSTOMIZED_ALERTS",e[e.CREATE_ALERT_LATER=2]="CREATE_ALERT_LATER"}(s||(s={}));var W="sentry.rules.conditions.event_frequency.EventUniqueUserFrequencyCondition",Q="sentry.rules.conditions.event_frequency.EventFrequencyCondition",ee=(n={},(0,v.Z)(n,o.ERRORS,Q),(0,v.Z)(n,o.USERS,W),n);function te(e,t,r){var n;switch(t){case o.ERRORS:n=Q;break;case o.USERS:n=W;break;default:throw new RangeError("Supplied metric value is not handled")}return{interval:e,id:n,value:r}}var re=function(e){(0,f.Z)(a,e);var t,r,n=(t=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,g.Z)(t);if(r){var o=(0,g.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,h.Z)(this,e)});function a(){return(0,d.Z)(this,a),n.apply(this,arguments)}return(0,p.Z)(a,[{key:"getDefaultState",value:function(){return K(K({},(0,z.Z)((0,g.Z)(a.prototype),"getDefaultState",this).call(this)),{},{conditions:[],intervalChoices:[],alertSetting:s.CREATE_ALERT_LATER.toString(),metric:o.ERRORS,interval:"",threshold:""})}},{key:"getAvailableMetricChoices",value:function(){var e=this;return[[o.ERRORS,(0,U.t)("occurrences of")],[o.USERS,(0,U.t)("users affected by")]].filter((function(t){var r,n,o=(0,M.Z)(t,1)[0];return null===(r=e.state.conditions)||void 0===r||null===(n=r.some)||void 0===n?void 0:n.call(r,(function(e){return(null==e?void 0:e.id)===ee[o]}))}))}},{key:"getIssueAlertsChoices",value:function(e){var t=this,r=[[s.CREATE_ALERT_LATER.toString(),(0,U.t)("I'll create my own alerts later")],[s.ALERT_ON_EVERY_ISSUE.toString(),(0,U.t)("Alert me on every new issue")]];return e&&r.push([s.CUSTOMIZED_ALERTS.toString(),(0,H.BX)(oe,{onClick:function(e){e.preventDefault();var r=s.CUSTOMIZED_ALERTS.toString();t.setStateAndUpdateParents({alertSetting:r})},children:[(0,U.t)("When there are more than"),(0,H.tZ)(se,{type:"number",min:"0",name:"",placeholder:"10",value:this.state.threshold,onChange:function(e){return t.setStateAndUpdateParents({threshold:e.target.value})},"data-test-id":"range-input"}),(0,H.tZ)(ae,{value:this.state.metric,choices:this.getAvailableMetricChoices(),onChange:function(e){return t.setStateAndUpdateParents({metric:e.value})},"data-test-id":"metric-select-control"}),(0,U.t)("a unique error in"),(0,H.tZ)(ae,{value:this.state.interval,choices:this.state.intervalChoices,onChange:function(e){return t.setStateAndUpdateParents({interval:e.value})},"data-test-id":"interval-select-control"})]},s.CUSTOMIZED_ALERTS)]),r.map((function(e){var t=(0,M.Z)(e,2),r=t[0],n=t[1];return[r,(0,H.tZ)(le,{children:n},r)]}))}},{key:"getUpdatedData",value:function(){var e,t;switch(parseInt(this.state.alertSetting,10)){case s.ALERT_ON_EVERY_ISSUE:e=!0,t=!1;break;case s.CREATE_ALERT_LATER:e=!1,t=!1;break;case s.CUSTOMIZED_ALERTS:e=!1,t=!0;break;default:throw new RangeError("Supplied alert creation action is not handled")}return{defaultRules:e,shouldCreateCustomRule:t,name:"Send a notification for new issues",conditions:this.state.interval.length>0&&this.state.threshold.length>0?[te(this.state.interval,this.state.metric,this.state.threshold)]:void 0,actions:[{id:"sentry.rules.actions.notify_event.NotifyEventAction"}],actionMatch:"all",frequency:5}}},{key:"setStateAndUpdateParents",value:function(e,t){var r=this;this.setState(e,(function(){null==t||t(),r.props.onChange(r.getUpdatedData())}))}},{key:"getEndpoints",value:function(){return[["conditions","/projects/".concat(this.props.organization.slug,"/rule-conditions/")]]}},{key:"onLoadAllEndpointsSuccess",value:function(){var e,t,r=this,n=null===(e=this.state.conditions)||void 0===e||null===(t=e.filter)||void 0===t?void 0:t.call(e,(function(e){return Object.values(ee).includes(null==e?void 0:e.id)}));if(n&&0!==n.length){var o=function(e){var t,r=e.map((function(e){var t,r;return null===(t=e.formFields)||void 0===t||null===(r=t.interval)||void 0===r?void 0:r.choices})).reduce((function(e,t){return e&&t&&V()(e,t)?e:null}));return{intervalChoices:r,interval:null==r||null===(t=r[0])||void 0===t?void 0:t[0]}}(n),s=o.intervalChoices,a=o.interval;if(!s||!a)return _.$e((function(e){e.setExtra("props",r.props),e.setExtra("state",r.state),_.Tb(new Error("Interval choices or sent from API endpoint is inconsistent or empty"))})),void this.setStateAndUpdateParents({conditions:void 0});this.setStateAndUpdateParents({conditions:n,intervalChoices:s,interval:a})}else this.setStateAndUpdateParents({conditions:void 0})}},{key:"renderBody",value:function(){var e,t=this,r=this.getIssueAlertsChoices((null===(e=this.state.conditions)||void 0===e?void 0:e.length)>0);return(0,H.BX)(b.Fragment,{children:[(0,H.tZ)(ce,{withMargins:!0,children:(0,U.t)("Set your default alert settings")}),(0,H.tZ)(ie,{choices:r,label:(0,U.t)("Options for creating an alert"),onChange:function(e){return t.setStateAndUpdateParents({alertSetting:e})},value:this.state.alertSetting})]})}}]),a}(Y.Z);const ne=(0,F.Z)(re);var oe=(0,a.Z)("div",{target:"e12p23qf5"})("display:grid;grid-template-columns:repeat(5, max-content);grid-gap:",(0,l.Z)(1),";align-items:center;"),se=(0,a.Z)(G.Z,{target:"e12p23qf4"})({name:"m0jwvv",styles:"width:80px"}),ae=(0,a.Z)(O.Z,{target:"e12p23qf3"})({name:"efbx4f",styles:"width:160px"}),ie=(0,a.Z)($.Z,{target:"e12p23qf2"})("padding:",(0,l.Z)(3)," 0;margin-bottom:50px;box-shadow:0 -1px 0 rgba(0, 0, 0, 0.1);"),ce=(0,a.Z)(w.Z,{target:"e12p23qf1"})({name:"1ojfw6c",styles:"margin-top:65px"}),le=(0,a.Z)("div",{target:"e12p23qf0"})({name:"p9mutn",styles:"min-height:35px;display:flex;flex-direction:column;justify-content:center"});function ue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function de(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(r),!0).forEach((function(t){(0,v.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var pe=function(e){(0,f.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,g.Z)(t);if(r){var o=(0,g.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,h.Z)(this,e)});function o(e,t){var r;(0,d.Z)(this,o),r=n.call(this,e,t),(0,v.Z)((0,m.Z)(r),"createProject",function(){var e=(0,u.Z)(y().mark((function e(t){var n,o,s,a,i,c,l,u,d,p,m,f,h,g,v,j,b,S,E,R,C,O;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=r.props,o=n.organization,s=n.api,a=r.state,i=a.projectName,c=a.platform,l=a.team,u=a.dataFragment,d=o.slug,m=(p=u||{}).shouldCreateCustomRule,f=p.name,h=p.conditions,g=p.actions,v=p.actionMatch,j=p.frequency,b=p.defaultRules,r.setState({inFlight:!0}),i||_.$e((function(e){e.setExtra("props",r.props),e.setExtra("state",r.state),_.uT("No project name")})),e.prev=7,e.next=10,s.requestPromise("/teams/".concat(d,"/").concat(l,"/projects/"),{method:"POST",data:{name:i,platform:c,default_rules:null==b||b}});case 10:if(S=e.sent,!m){e.next=16;break}return e.next=14,s.requestPromise("/projects/".concat(o.slug,"/").concat(S.slug,"/rules/"),{method:"POST",data:{name:f,conditions:h,actions:g,actionMatch:v,frequency:j}});case 14:R=e.sent,E=R.id;case 16:r.trackIssueAlertOptionSelectedEvent(S,b,m,E),x.Z.createSuccess(S),C=c||"other",O="/".concat(o.slug,"/").concat(S.slug,"/getting-started/").concat(C,"/"),Z.browserHistory.push(O),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(7),r.setState({inFlight:!1,error:e.t0.responseJSON.detail}),403!==e.t0.status&&409!==e.t0.status&&_.$e((function(t){t.setExtra("err",e.t0),t.setExtra("props",r.props),t.setExtra("state",r.state),_.uT("Project creation failed")}));case 27:case"end":return e.stop()}}),e,null,[[7,23]])})));return function(t){return e.apply(this,arguments)}}()),(0,v.Z)((0,m.Z)(r),"setPlatform",(function(e){return r.setState((function(t){var r=t.projectName,n=t.platform;return{platform:e,projectName:!r||n&&(0,I.Z)(n)===r?(0,I.Z)(e)||"":r}}))}));var s=e.location.query,a=e.organization.teams.filter((function(e){return e.hasAccess})),i=s.team||a.length&&a[0].slug,c=(0,I.Z)(s.platform)?s.platform:"";return r.state={error:!1,projectName:(0,I.Z)(c)||"",team:i,platform:c,inFlight:!1,dataFragment:void 0},r}return(0,p.Z)(o,[{key:"defaultCategory",get:function(){var e,t,r=this.props.location.query;return e=r.category,null===(t=T.ZP.find((function(t){return t.id===e})))||void 0===t?void 0:t.id}},{key:"renderProjectForm",value:function(){var e=this,t=this.props.organization,r=this.state,n=r.projectName,o=r.platform,s=r.team,a=this.props.teams.filter((function(e){return e.hasAccess})),i=(0,H.BX)(fe,{onSubmit:this.createProject,children:[(0,H.BX)("div",{children:[(0,H.tZ)(he,{children:(0,U.t)("Project name")}),(0,H.BX)(ve,{children:[(0,H.tZ)(ge,{platform:null!=o?o:""}),(0,H.tZ)("input",{type:"text",name:"name",placeholder:(0,U.t)("Project name"),autoComplete:"off",value:n,onChange:function(t){return e.setState({projectName:(0,D.Z)(t.target.value)})}})]})]}),(0,H.BX)("div",{children:[(0,H.tZ)(he,{children:(0,U.t)("Team")}),(0,H.BX)(je,{children:[(0,H.tZ)(O.Z,{name:"select-team",clearable:!1,value:s,placeholder:(0,U.t)("Select a Team"),onChange:function(t){return e.setState({team:t.value})},options:a.map((function(e){var t=e.slug;return{label:"#".concat(t),value:t}}))}),(0,H.tZ)(A.Z,{title:(0,U.t)("Create a team"),children:(0,H.tZ)(C.ZP,{borderless:!0,"data-test-id":"create-team",type:"button",icon:(0,H.tZ)(k.N_,{isCircled:!0}),onClick:function(){return(0,E.openCreateTeamModal)({organization:t,onClose:function(t){var r=t.slug;return e.setState({team:r})}})}})})]})]}),(0,H.tZ)("div",{children:(0,H.tZ)(C.ZP,{"data-test-id":"create-project",priority:"primary",disabled:!this.canSubmitForm,children:(0,U.t)("Create Project")})})]});return(0,H.BX)(b.Fragment,{children:[(0,H.tZ)(w.Z,{withMargins:!0,children:(0,U.t)("Give your project a name")}),i]})}},{key:"canSubmitForm",get:function(){var e,t=this.state,r=t.projectName,n=t.team,o=t.inFlight,s=this.state.dataFragment||{},a=s.shouldCreateCustomRule,i=s.conditions;return!o&&n&&""!==r&&(!a||(null==i||null===(e=i.every)||void 0===e?void 0:e.call(i,(function(e){return e.value}))))}},{key:"trackIssueAlertOptionSelectedEvent",value:function(e,t,r,n){var o={eventKey:"new_project.alert_rule_selected",eventName:"New Project Alert Rule Selected",organization_id:this.props.organization.id,project_id:e.id,rule_type:t?"Default":r?"Custom":"No Rule"};void 0!==n&&(o=de(de({},o),{},{custom_rule_id:n})),(0,N.ec)(o)}},{key:"render",value:function(){var e=this,t=this.state,r=t.platform,n=t.error;return(0,H.BX)(b.Fragment,{children:[n&&(0,H.tZ)(R.Z,{type:"error",children:n}),(0,H.BX)("div",{"data-test-id":"onboarding-info",children:[(0,H.tZ)(w.Z,{withMargins:!0,children:(0,U.t)("Create a new Project")}),(0,H.tZ)(ye,{children:(0,U.t)("Projects allow you to scope error and transaction events to a specific\n               application in your organization. For example, you might have separate\n               projects for your API server and frontend client.")}),(0,H.tZ)(w.Z,{withMargins:!0,children:(0,U.t)("Choose a platform")}),(0,H.tZ)(P.Z,{platform:r,defaultCategory:this.defaultCategory,setPlatform:this.setPlatform,showOther:!0}),(0,H.tZ)(ne,{onChange:function(t){e.setState({dataFragment:t})}}),this.renderProjectForm()]})]})}}]),o}(b.Component);pe.displayName="CreateProject";const me=(0,q.Z)((0,Z.withRouter)((0,F.Z)((0,B.Z)(pe))));var fe=(0,a.Z)("form",{target:"e1icdt8d5"})("display:grid;grid-template-columns:300px 250px max-content;grid-gap:",(0,l.Z)(2),";align-items:end;padding:",(0,l.Z)(3)," 0;box-shadow:0 -1px 0 rgba(0, 0, 0, 0.1);background:",(function(e){return e.theme.background}),";"),he=(0,a.Z)("div",{target:"e1icdt8d4"})("font-size:",(function(e){return e.theme.fontSizeExtraLarge}),";margin-bottom:",(0,l.Z)(1),";"),ge=(0,a.Z)(S.v,{target:"e1icdt8d3"})("margin-right:",(0,l.Z)(1),";"),ve=(0,a.Z)("div",{target:"e1icdt8d2"})((function(e){return(0,L.T)(e)}),";padding:5px 10px;display:flex;align-items:center;input{background:",(function(e){return e.theme.background}),";border:0;outline:0;flex:1;}"),je=(0,a.Z)("div",{target:"e1icdt8d1"})({name:"1gijyrs",styles:"display:grid;grid-template-columns:1fr min-content;align-items:center"}),ye=(0,a.Z)("p",{target:"e1icdt8d0"})("color:",(function(e){return e.theme.subText}),";max-width:760px;"),be=function(){return(0,H.tZ)(Ze,{children:(0,H.tZ)("div",{className:"container",children:(0,H.BX)(_e,{children:[(0,H.tZ)(c(),{title:"Sentry"}),(0,H.tZ)(me,{})]})})})};be.displayName="NewProject";var Ze=(0,a.Z)("div",{target:"escx7041"})("flex:1;background:",(function(e){return e.theme.background}),";margin-bottom:-",(0,l.Z)(3),";"),_e=(0,a.Z)("div",{target:"escx7040"})("margin-top:",(0,l.Z)(3),";");const Se=be}}]);
//# sourceMappingURL=app_views_projectInstall_newProject_tsx.js.map