(this.webpackJsonpsqllineagejs=this.webpackJsonpsqllineagejs||[]).push([[0],{463:function(e,t,n){},742:function(e,t,n){"use strict";n.r(t);var r,i=n(7),a=n.n(i),o=n(89),c=n.n(o),s=(n(463),n(36)),d=n(22),l=n(806),u=n(764),j=n(807),b=n(762),h=n(804),f=n(810),g=n(811),O=n(805),p=n(808),m=n(425),x=n.n(m),v=n(426),y=n.n(v),w=n(356),S=n.n(w),C=n(134),L=n(12),E=n.n(L),_=n(231),N=n(210),k=n(213),T=n(445);function I(e){var t=new URL(window.location.href),n=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_PORT,r=n?t.origin.replace(t.port,n):t.origin;return"".concat(r).concat(e)}function D(e){return P.apply(this,arguments)}function P(){return(P=Object(_.a)(E.a.mark((function e(t){var n,r,i,a,o,c,s,d=arguments;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:{},r=n.body,i=Object(T.a)(n,["body"]),a={"Content-Type":"application/json"},o=Object(k.a)(Object(k.a)({method:r?"POST":"GET"},i),{},{headers:Object(k.a)(Object(k.a)({},a),i.headers)}),r&&(o.body=JSON.stringify(r)),e.next=6,window.fetch(t,o);case 6:return s=e.sent,e.next=9,s.json();case 9:if(c=e.sent,!s.ok){e.next=14;break}return e.abrupt("return",c);case 14:return e.abrupt("return",Promise.reject(c||s.statusText));case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}D.get=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return D(e,Object(k.a)(Object(k.a)({},t),{},{method:"GET"}))},D.post=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return D(e,Object(k.a)(Object(k.a)({},n),{},{body:t}))};var z=Object(N.b)("editor/fetchContent",function(){var e=Object(_.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.post(I("/script"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),H=Object(N.b)("dag/fetchDAG",function(){var e=Object(_.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.post(I("/lineage"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Q=Object(N.c)({name:"editor",initialState:{file:"",content:"",contentComposed:"",editable:!1,editorStatus:"idle",editorError:null,dagContent:[],dagVerbose:"",dagStatus:"idle",dagError:null},reducers:{setContentComposed:function(e,t){e.contentComposed=t.payload},setEditable:function(e,t){e.editable=t.payload},setFile:function(e,t){e.file=t.payload}},extraReducers:(r={},Object(s.a)(r,z.pending,(function(e){e.editorStatus="loading"})),Object(s.a)(r,z.fulfilled,(function(e,t){e.editorStatus="succeeded",e.content=t.payload.content})),Object(s.a)(r,z.rejected,(function(e,t){e.editorStatus="failed",e.editorError=t.error.message})),Object(s.a)(r,H.pending,(function(e){e.dagStatus="loading"})),Object(s.a)(r,H.fulfilled,(function(e,t){e.dagStatus="succeeded",e.dagContent=t.payload.dag,e.dagVerbose=t.payload.verbose})),Object(s.a)(r,H.rejected,(function(e,t){e.dagStatus="failed",e.dagError=t.error.message})),r)}),R=function(e){return e.editor},V=Q.actions,W=V.setContentComposed,M=V.setEditable,B=V.setFile,A=Q.reducer,F=n(793),G=n(794),K=n(38);function q(e){return Object(K.jsx)(l.a,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:e.minHeight,children:Object(K.jsx)(F.a,{in:!0,style:{transitionDelay:"500ms"},unmountOnExit:!0,children:Object(K.jsx)(G.a,{})})})}var U=n(431),J=n.n(U),Z=n(432),Y=n.n(Z);function X(e){var t=e.info?J.a:Y.a;return Object(K.jsx)(l.a,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:e.minHeight,children:Object(K.jsxs)("span",{children:[Object(K.jsx)(t,{color:"primary",fontSize:"large"}),e.message.split("\n").map((function(e){return Object(K.jsx)("p",{children:e})}))]})})}var $=n(812),ee=n(813),te=n(796),ne=n(797),re=n(434),ie=n.n(re),ae=n(435),oe=n.n(ae),ce=n(436),se=n.n(ce),de=n(437),le=n.n(de);S.a.use(y.a);var ue=Object(te.a)((function(e){return{speedDial:{position:"absolute","&.MuiSpeedDial-directionLeft":{bottom:e.spacing(5),right:e.spacing(2)}}}}));function je(e){var t=ue(),n=Object(C.c)(R),r=a.a.useState(!1),o=Object(d.a)(r,2),c=o[0],s=o[1],l=Object(i.useRef)(null);if(Object(i.useEffect)((function(){if(l.current){var e=l.current._cy;e.on("mouseover","node",(function(t){var n=t.target,r=n.union(n.successors()).union(n.predecessors());r.addClass("highlight"),e.elements().difference(r).addClass("semitransparent")})),e.on("mouseout","node",(function(){e.elements().removeClass("semitransparent"),e.elements().removeClass("highlight")}))}})),"loading"===n.dagStatus)return Object(K.jsx)(q,{minHeight:e.height});if("failed"===n.dagStatus)return Object(K.jsx)(X,{minHeight:e.height,message:n.dagError+"\nPlease check your SQL code for potential syntax error in Script View."});if(0===n.dagContent.length){var u,j=!1;return n.editable?""===n.contentComposed?(u="Welcome to SQLLineage Playground.\nJust paste your SQL in Script View and switch back here, you'll get DAG visualization for your SQL code.\nOr select SQL file on the left directory tree for visualization.\nHave fun!",j=!0):u="No Lineage Info found in your SQL.\nPlease review your code in Script View.":u="No Lineage Info found in SQL file ".concat(n.file,".\nPlease review the code in Script View."),Object(K.jsx)(X,{minHeight:e.height,message:u,info:j})}var b={width:e.width,height:e.height};return Object(K.jsxs)("div",{children:[Object(K.jsx)(x.a,{elements:n.dagContent,stylesheet:[{selector:"node",style:{height:10,width:10,content:"data(id)","text-valign":"top","text-halign":"right","font-size":10,color:"#35393e","background-color":"#2fc1d3","border-color":"#000","border-width":1,"border-opacity":.8}},{selector:"edge",style:{width:1,"line-color":"#9ab5c7","target-arrow-color":"#9ab5c7","target-arrow-shape":"triangle","arrow-scale":.8,"curve-style":"bezier"}},{selector:".highlight",style:{"background-color":"#076fa1"}},{selector:".semitransparent",style:{opacity:"0.2"}}],style:b,layout:{name:"dagre",rankDir:"LR",rankSep:200},zoom:1,minZoom:.5,maxZoom:2,wheelSensitivity:.2,ref:l}),Object(K.jsxs)($.a,{ariaLabel:"SpeedDial example",className:t.speedDial,hidden:!1,icon:Object(K.jsx)(ee.a,{}),onClose:function(){return s(!1)},onOpen:function(){return s(!0)},open:c,direction:"left",FabProps:{size:"small"},children:[Object(K.jsx)(ne.a,{title:"Save",icon:Object(K.jsx)(ie.a,{}),onClick:function(){if(l.current){var e=l.current._cy,t=document.createElement("a");t.download="".concat(n.file,".jpg"),t.href=e.jpg({full:!0,quality:1}),t.click(),s(!1)}}}),Object(K.jsx)(ne.a,{title:"Zoom In",icon:Object(K.jsx)(oe.a,{}),onClick:function(){l.current._cy.zoom(l.current._cy.zoom()+.1)}}),Object(K.jsx)(ne.a,{title:"Auto Fit",icon:Object(K.jsx)(se.a,{}),onClick:function(){l.current._cy.fit()}}),Object(K.jsx)(ne.a,{title:"Zoom Out",icon:Object(K.jsx)(le.a,{}),onClick:function(){l.current._cy.zoom(l.current._cy.zoom()-.1)}})]})]})}var be=n(332),he=n(110);function fe(e){var t=Object(C.b)(),n=Object(C.c)(R),r=new URLSearchParams(Object(he.e)().search),a=Object(he.d)();Object(i.useEffect)((function(){var e=r.get("e");if(null!==e)t(W(e)),a.push("/");else{var i=r.get("f");n.file!==i&&(t(B(i)),null===i?(t(M(!0)),t(H({e:n.contentComposed}))):(t(M(!1)),t(z({f:i})),t(H({f:i}))))}}));if("loading"===n.editorStatus)return Object(K.jsx)(q,{minHeight:e.height});if("failed"===n.editorStatus)return Object(K.jsx)(X,{minHeight:e.height,message:n.editorError});var o={minimap:{enabled:!1},readOnly:!n.editable,wordWrap:"on",automaticLayout:!0};return Object(K.jsx)(be.a,{width:e.width,height:e.height,language:"sql",value:n.editable?n.contentComposed:n.content,options:o,editorDidMount:function(e,n){var r=n.editor.EditorOption.readOnly;e.onDidBlurEditorText((function(){e.getOption(r)||(t(W(e.getValue())),t(H({e:e.getValue()})))})),e.onKeyDown((function(){e.getOption(r)&&e.trigger(n.KeyCode.Backspace,"deleteLeft")}))}})}var ge,Oe=n(801),pe=n(802),me=n(803),xe=n(443),ve=n.n(xe),ye=n(444),we=n.n(ye),Se=n(761),Ce=n(442),Le=n.n(Ce),Ee=n(45),_e=function(){var e=Object(_.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.post(I("/directory"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ne=Object(N.b)("directory/fetchDirectory",_e),ke=Object(N.c)({name:"directory",initialState:{content:{},status:"idle",error:null,openNonSQLWarning:!1},reducers:{setOpenNonSQLWarning:function(e,t){e.openNonSQLWarning=t.payload}},extraReducers:(ge={},Object(s.a)(ge,Ne.pending,(function(e){e.status="loading"})),Object(s.a)(ge,Ne.fulfilled,(function(e,t){e.status="succeeded",e.content=t.payload})),Object(s.a)(ge,Ne.rejected,(function(e,t){e.status="failed",e.error=t.error.message})),ge)}),Te=function(e){return e.directory},Ie=ke.actions.setOpenNonSQLWarning,De=ke.reducer,Pe=n(809),ze=n(800),He=n(814),Qe=n(438),Re=n.n(Qe),Ve=n(439),We=n.n(Ve),Me=n(440),Be=n.n(Me),Ae=n(441),Fe=n.n(Ae),Ge=Object(te.a)((function(e){return{"@global":{".MuiTreeItem-root.Mui-selected > .MuiTreeItem-content .MuiTreeItem-label":{backgroundColor:"white"}},directory:{marginLeft:e.spacing(.2)},labelRoot:{display:"flex",alignItems:"center",padding:e.spacing(.1,0)},labelIcon:{marginRight:e.spacing(.2)},labelText:{fontWeight:"inherit",flexGrow:1}}}));function Ke(e){var t=Ge(),n=Object(he.d)(),r=Object(C.b)(),o=Object(C.c)(Te),c=a.a.useState(null),s=Object(d.a)(c,2),l=s[0],u=s[1],j=a.a.useState([]),b=Object(d.a)(j,2),h=b[0],f=b[1];Object(i.useEffect)((function(){var t;e.is_root&&(u((null!==(t=o.content.children)&&void 0!==t?t:[]).map((function(e){return Object(K.jsx)(Ke,{id:e.id,name:e.name,is_dir:e.is_dir,is_root:!1})}))),f([e.id]))}),[o.content.children,e.id,e.is_root]);return Object(K.jsx)(ze.a,{className:t.directory,defaultCollapseIcon:Object(K.jsx)(Re.a,{}),defaultExpandIcon:Object(K.jsx)(We.a,{}),expanded:h,onNodeSelect:function(){e.is_dir||(e.name.endsWith(".sql")?n.push("/?f=".concat(e.id)):r(Ie(!0)))},onNodeToggle:function(e,t){var n=t.filter((function(e){return!h.includes(e)}));if(f(t),n[0]){var r=n[0];_e({d:r}).then((function(e){return u(e.children.map((function(e){return Object(K.jsx)(Ke,{id:e.id,name:e.name,is_dir:e.is_dir,is_root:!1})})))}))}},children:Object(K.jsx)(He.a,{nodeId:e.id,label:Object(K.jsxs)("div",{className:t.labelRoot,children:[e.is_dir?Object(K.jsx)(Be.a,{color:"action",className:t.labelIcon}):Object(K.jsx)(Fe.a,{color:"action",className:t.labelIcon}),Object(K.jsx)(Se.a,{variant:"body2",className:t.labelText,children:e.name})]}),children:e.is_dir&&(l||[Object(K.jsx)("div",{},"stub")])},e.id)})}function qe(e){var t=Object(C.b)(),n=Object(C.c)(Te);return Object(i.useEffect)((function(){if("idle"===n.status){var e=new URL(window.location.href);t(Ne(Object.fromEntries(e.searchParams)))}})),"loading"===n.status?Object(K.jsx)(q,{minHeight:e.height}):"failed"===n.status?Object(K.jsx)(X,{minHeight:e.height,message:n.error}):Object(K.jsxs)("div",{children:[Object(K.jsx)(Ke,{id:n.content.id,name:n.content.name,is_dir:!0,is_root:!0}),Object(K.jsx)(Pe.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:n.openNonSQLWarning,autoHideDuration:1e3,onClose:function(){t(Ie(!1))},message:"Non SQL File Is Not Supported"})]})}var Ue=n(272);function Je(e){var t=Object(C.c)(R);if("loading"===t.dagStatus)return Object(K.jsx)(q,{minHeight:e.height});if("failed"===t.dagStatus)return Object(K.jsx)(X,{minHeight:e.height,message:t.dagError+"\nPlease check your SQL code for potential syntax error in Script View."});return Object(K.jsx)(be.a,{width:e.width,height:e.height,value:t.dagVerbose,options:{minimap:{enabled:!1},readOnly:!0,wordWrap:"on",automaticLayout:!0}})}var Ze=Object(te.a)((function(e){return{appBar:{flexGrow:1,zIndex:e.zIndex.drawer+1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},content:{padding:e.spacing(.5),marginTop:e.spacing(6),float:"right"},hide:{display:"none"},drawerPaper:{width:function(e){return e.drawerWidth+"vw"}},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},dragger:{width:"5px",cursor:"ew-resize",position:"absolute",top:0,bottom:0,left:function(e){return e.drawerWidth+"vw"},backgroundColor:"transparent",zIndex:999}}})),Ye=null;function Xe(){var e=Object(C.c)(R),t=a.a.useState("dag"),n=Object(d.a)(t,2),r=n[0],o=n[1],c=a.a.useState(!0),m=Object(d.a)(c,2),x=m[0],v=m[1],y=a.a.useState(18),w=Object(d.a)(y,2),S=w[0],L=w[1],E=Ze({drawerWidth:S}),_="90vh",N=Object(i.useMemo)((function(){return(x?100-S:100)+"vw"}),[x,S]),k=function(e){if(Ye){var t=100*e.clientX/window.innerWidth;t>10&&t<50&&L(t)}},T=function e(){Ye&&(Ye=!1,document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",e))};return Object(K.jsx)(Ue.a,{children:Object(K.jsxs)("div",{children:[Object(K.jsxs)(l.a,{children:[Object(K.jsx)(Oe.a,{position:"fixed",className:E.appBar,children:Object(K.jsxs)(pe.a,{variant:"dense",children:[Object(K.jsx)(me.a,{edge:"start",className:E.menuButton,color:"inherit","aria-label":"menu",onClick:function(){v(!x)},children:x?Object(K.jsx)(Le.a,{}):Object(K.jsx)(ve.a,{})}),Object(K.jsx)(Se.a,{variant:"h6",className:E.title,children:"SQLLineage"}),e.editable?Object(K.jsx)(u.a,{title:"Visualize Lineage By Filling In Your Own SQL",arrow:!0,children:Object(K.jsx)("div",{children:"Composing Mode"})}):Object(K.jsx)(Ue.b,{to:"/",style:{color:"white"},children:Object(K.jsx)(u.a,{title:"Enter Composing Mode to Visualize Your Own SQL",arrow:!0,children:Object(K.jsx)(me.a,{color:"inherit",onClick:function(){o("script"),v(!1)},children:Object(K.jsx)(we.a,{})})})})]})}),Object(K.jsx)(j.a,{variant:"persistent",open:x,classes:{paper:E.drawerPaper},children:Object(K.jsx)(l.a,{className:E.content,children:Object(K.jsx)(qe,{})})})]}),Object(K.jsx)("div",{id:"dragger",onMouseDown:function(e){e.stopPropagation(),e.preventDefault(),document.addEventListener("mousemove",k),document.addEventListener("mouseup",T),Ye=!0},className:Object(Ee.a)(E.dragger,Object(s.a)({},E.hide,!x))}),Object(K.jsxs)("main",{className:Object(Ee.a)(E.content,Object(s.a)({},E.contentShift,x)),children:[Object(K.jsxs)(b.a,{elevation:"24",style:{height:_,width:N},children:[Object(K.jsx)(l.a,{className:"dag"===r?"":E.hide,children:Object(K.jsx)(je,{height:_,width:N})}),Object(K.jsx)(l.a,{className:"text"===r?"":E.hide,children:Object(K.jsx)(Je,{height:_,width:N})}),Object(K.jsx)(l.a,{className:"script"===r?"":E.hide,children:Object(K.jsx)(fe,{height:_,width:N})})]}),Object(K.jsx)(h.a,{container:!0,justify:"center",children:Object(K.jsx)(f.a,{component:"fieldset",children:Object(K.jsxs)(g.a,{row:!0,"aria-label":"position",name:"position",defaultValue:"dag",value:r,onChange:function(e){return o(e.target.value)},children:[Object(K.jsx)(O.a,{value:"dag",control:Object(K.jsx)(p.a,{color:"primary"}),label:"Lineage View"}),Object(K.jsx)(O.a,{value:"text",control:Object(K.jsx)(p.a,{color:"primary"}),label:"Text View"}),Object(K.jsx)(O.a,{value:"script",control:Object(K.jsx)(p.a,{color:"primary"}),label:"Script View"})]})})})]})]})})}var $e=Object(N.a)({reducer:{directory:De,editor:A}});c.a.render(Object(K.jsx)(a.a.StrictMode,{children:Object(K.jsx)(C.a,{store:$e,children:Object(K.jsx)(Xe,{})})}),document.getElementById("root"))}},[[742,1,2]]]);
//# sourceMappingURL=main.12d3a4da.chunk.js.map