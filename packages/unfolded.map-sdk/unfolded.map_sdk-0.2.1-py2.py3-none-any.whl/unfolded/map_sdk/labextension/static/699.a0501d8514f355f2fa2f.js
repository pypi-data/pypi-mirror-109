(self.webpackChunk_unfolded_jupyter_map_sdk=self.webpackChunk_unfolded_jupyter_map_sdk||[]).push([[699],{699:(e,t,n)=>{"use strict";var i;n.r(t),n.d(t,{EventType:()=>i,_addTileset:()=>_,addDataset:()=>A,addLayer:()=>N,createMap:()=>c,getLayerTimelineInfo:()=>I,getLayers:()=>m,getMapUrl:()=>u,getTimelineInfo:()=>y,refreshMapData:()=>T,removeDataset:()=>w,removeLayer:()=>C,setFilter:()=>R,setLayerTimelineConfig:()=>L,setLayerVisibility:()=>p,setMapControlVisibility:()=>b,setTheme:()=>g,setTimelineAnimationSpeed:()=>E,setTimelineConfig:()=>M,setTimelineInterval:()=>v,setViewState:()=>f,toggleTimelineAnimation:()=>h,toggleTimelineVisibility:()=>k}),function(e){e.LOAD="load",e.FILTER="filter",e.TIMELINE_INTERVAL_CHANGE="timelineIntervalChange",e.LAYER_TIMELINE_TIME_CHANGE="layerTimelineTimeChange"}(i||(i={}));var r,s=function(){function e(){this.registry=new Map}return e.prototype.register=function(e,t){for(var n=0,i=o(e);n<i.length;n++){var r=i[n],s=this.registry.get(r);s||(s=new Array,this.registry.set(r,s)),s.push(t)}},e.prototype.unregister=function(e,t){for(var n=0,i=o(e);n<i.length;n++){var r=i[n],s=this.registry.get(r);s&&a(s,t)}},e.prototype.invoke=function(e,t){var n=this.registry.get(e);if(n)for(var i=0,r=n;i<r.length;i++)(0,r[i])(t,e)},e}();function a(e,t){var n=e.indexOf(t);return n>-1&&e.splice(n,1),e}function o(e){return Array.isArray(e)?e:[e]}var d=((r={})["map-sdk-initialized-response"]=i.LOAD,r["map-sdk-timeline-interval-changed-response"]=i.TIMELINE_INTERVAL_CHANGE,r["map-sdk-layer-animation-time-changed-response"]=i.LAYER_TIMELINE_TIME_CHANGE,r["map-sdk-filter-changed-response"]=i.FILTER,r);function u(e){return"https://studio.unfolded.ai/public/"+e}var l=function(){function e(e){var t=this;this.iframe=document.createElement("iframe"),this.callbackRegistry=new s;var n=e.mapUUID?u(e.mapUUID):e.mapUrl;if(!n)throw new Error("Either mapUUID or mapUrl must be specified");var r=e.id||"unfolded_iframe",a=e.appendToDocument,o=e.appendToId||"",l=e.width||400,c=e.height||250,f=e.embed||!1,m=e.onLoad,p=e.onTimelineIntervalChange,g=e.onLayerTimelineTimeChange;m&&this.callbackRegistry.register(i.LOAD,m),p&&this.callbackRegistry.register(i.TIMELINE_INTERVAL_CHANGE,p),g&&this.callbackRegistry.register(i.LAYER_TIMELINE_TIME_CHANGE,g),window.addEventListener("message",(function(e){!function(e,t,n,i,r){var s=function(e){if("string"==typeof e.data)try{var t=JSON.parse(e.data),n=t.source,i=t.type;if("unfolded-sdk-server"!==n||!i)return;return t}catch(e){return}}(e);if(s){var a=s.data,o=s.type,u=d[o];if(u&&r.invoke(u,a),t&&n&&i)switch(o){case t+"-response":n(a);break;case t+"-error":i(new Error(null==a?void 0:a.message))}}}(e,t.type,t.resolve,t.reject,t.callbackRegistry)})),function(e,t,n,i,r,s,a,o){if(n&&(t+="/embed"),e.setAttribute("src",t),e.setAttribute("id",i),a&&(e.style.width=a+"px"),o&&(e.style.height=o+"px"),r)if(s&&document.getElementById(s)){var d=document.getElementById(s);d&&d.appendChild(e)}else document.body.appendChild(e)}(this.iframe,n,f,r,a,o,l,c)}return e.prototype.sendMessage=function(e,t){var n=this,i=this.iframe;return new Promise((function(r,s){var a,o,d=(a={type:e,source:"unfolded-sdk-client",data:t},o=new Set,JSON.stringify(a,(function(e,t){if("object"==typeof t&&null!==t){if(o.has(t))try{return JSON.parse(JSON.stringify(t))}catch(e){return}o.add(t)}return t})));i&&i.contentWindow&&(i.contentWindow.postMessage(d,"*"),n.type=e,n.resolve=r,n.reject=s)}))},e.prototype.on=function(e,t){this.callbackRegistry.register(e,t)},e.prototype.off=function(e,t){this.callbackRegistry.unregister(e,t)},e}();function c(e){return new l(e)}function f(e,t){return e.sendMessage("map-sdk-set-view-state",{viewState:t})}function m(e){return e.sendMessage("map-sdk-get-layers",{})}function p(e,t,n){return e.sendMessage("map-sdk-set-layer-visibility",{layerId:t,isVisible:n})}function g(e,t){return e.sendMessage("map-sdk-set-theme",{theme:t})}function y(e,t){return e.sendMessage("map-sdk-get-timeline-info",{idx:t})}function h(e,t){return e.sendMessage("map-sdk-toggle-timeline-animation",{idx:t})}function k(e,t){return e.sendMessage("map-sdk-toggle-timeline-visibility",{idx:t})}function v(e,t,n,i){return e.sendMessage("map-sdk-set-timeline-interval",{idx:t,startTime:n,endTime:i})}function E(e,t,n){return e.sendMessage("map-sdk-set-timeline-speed",{idx:t,speed:n})}function M(e,t){return e.sendMessage("map-sdk-set-timeline-config",{config:t})}function T(e){return e.sendMessage("map-sdk-reload-map-data",{})}function I(e){return e.sendMessage("map-sdk-get-layer-timeline-info",{})}function L(e,t){return e.sendMessage("map-sdk-set-layer-timeline-config",{config:t})}function b(e,t){return e.sendMessage("map-sdk-set-map-control-visibility",{config:t})}function _(e,t){return e.sendMessage("map-sdk-add-tileset-top-map",{tileset:t})}function A(e,t){return e.sendMessage("map-sdk-add-dataset-to-map",{uuid:t}).then((function(e){return e&&"ok"===e.status}))}function w(e,t){return e.sendMessage("map-sdk-remove-dataset-from-map",{uuid:t}).then((function(e){return e&&"ok"===e.status}))}function N(e,t){return e.sendMessage("map-sdk-add-layer",t).then((function(e){return e&&"ok"===e.status}))}function C(e,t){return e.sendMessage("map-sdk-remove-layer",{id:t}).then((function(e){return e&&"ok"===e.status}))}function R(e,t){return e.sendMessage("map-sdk-set-filter",{info:t}).then((function(e){return e&&"ok"===e.status}))}}}]);