(self.webpackChunk_unfolded_jupyter_map_sdk=self.webpackChunk_unfolded_jupyter_map_sdk||[]).push([[950],{950:(e,t,n)=>{"use strict";var i;n.r(t),n.d(t,{ActionType:()=>i,UnfoldedMap:()=>o,_addTileset:()=>A,addDataset:()=>v,addLayer:()=>S,createMap:()=>d,getLayerTimelineInfo:()=>M,getLayers:()=>p,getMapUrl:()=>s,getTimelineInfo:()=>f,refreshMapData:()=>L,removeDataset:()=>N,removeFilter:()=>O,removeLayer:()=>k,setFilter:()=>D,setLayerTimelineConfig:()=>g,setLayerVisibility:()=>T,setMapControlVisibility:()=>h,setTheme:()=>l,setTimelineAnimationSpeed:()=>_,setTimelineConfig:()=>y,setTimelineInterval:()=>I,setViewState:()=>E,toggleTimelineAnimation:()=>m,toggleTimelineVisibility:()=>c}),function(e){e.SET_VIEW_STATE="map-sdk-set-view-state",e.GET_LAYERS="map-sdk-get-layers",e.ADD_LAYER="map-sdk-add-layer",e.REMOVE_LAYER="map-sdk-remove-layer",e.SET_LAYER_VISIBILITY="map-sdk-set-layer-visibility",e.SET_THEME="map-sdk-set-theme",e.MAP_INITIALIZED="map-sdk-initialized",e.GET_TIMELINE_INFO="map-sdk-get-timeline-info",e.TOGGLE_TIMELINE_ANIMATION="map-sdk-toggle-timeline-animation",e.TOGGLE_TIMELINE_VISIBILITY="map-sdk-toggle-timeline-visibility",e.SET_TIMELINE_INTERVAL="map-sdk-set-timeline-interval",e.TIMELINE_INTERVAL_CHANGED="map-sdk-timeline-interval-changed",e.SET_TIMELINE_SPEED="map-sdk-set-timeline-speed",e.SET_TIMELINE_CONFIG="map-sdk-set-timeline-config",e.REFRESH_MAP_DATA="map-sdk-reload-map-data",e.GET_LAYER_TIMELINE_INFO="map-sdk-get-layer-timeline-info",e.LAYER_ANIMATION_TIME_CHANGED="map-sdk-layer-animation-time-changed",e.SET_LAYER_TIMELINE_CONFIG="map-sdk-set-layer-timeline-config",e.SET_MAP_CONTROL_VISIBILITY="map-sdk-set-map-control-visibility",e.ADD_TILESET_TO_MAP="map-sdk-add-tileset-top-map",e.ADD_DATASET_TO_MAP="map-sdk-add-dataset-to-map",e.REMOVE_DATASET_FROM_MAP="map-sdk-remove-dataset-from-map",e.SET_FILTER="map-sdk-set-filter",e.REMOVE_FILTER="map-sdk-remove-filter",e.FILTER_CHANGED="map-sdk-filter-changed"}(i||(i={}));var r=function(){return(r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function s(e){return"https://studio.unfolded.ai/public/"+e}var a=function(){function e(e,t){var n=this;this.mapEventHandlers={},this.iframe=e;var r=t.onLoad,s=t.onTimelineIntervalChange,a=t.onLayerTimelineTimeChange,o=t.onFilter;this.mapEventHandlers={onLoad:r,onTimelineIntervalChange:s,onLayerTimelineTimeChange:a,onFilter:o},window.addEventListener("message",(function(e){!function(e,t,n,r,s){var a=function(e){if("string"==typeof e.data)try{var t=JSON.parse(e.data),n=t.source,i=t.type;if("unfolded-sdk-server"!==n||!i)return;return t}catch(e){return}}(e);if(a){var o=a.data,u=a.type;if(function(e,t,n){switch(e){case i.MAP_INITIALIZED+"-response":t.onLoad&&t.onLoad();break;case i.TIMELINE_INTERVAL_CHANGED+"-response":t.onTimelineIntervalChange&&t.onTimelineIntervalChange(n);break;case i.LAYER_ANIMATION_TIME_CHANGED+"-response":t.onLayerTimelineTimeChange&&t.onLayerTimelineTimeChange(n);break;case i.FILTER_CHANGED+"-response":t.onFilter&&t.onFilter(n)}}(u,s,o),t&&n&&r)switch(u){case t+"-response":n(o);break;case t+"-error":r(new Error(null==o?void 0:o.message))}}}(e,n.type,n.resolve,n.reject,n.mapEventHandlers)}))}return e.prototype.sendMessage=function(e,t){var n=this,i=this.iframe;return new Promise((function(r,s){var a,o,u=(a={type:e,source:"unfolded-sdk-client",data:t},o=new Set,JSON.stringify(a,(function(e,t){if("object"==typeof t&&null!==t){if(o.has(t))try{return JSON.parse(JSON.stringify(t))}catch(e){return}o.add(t)}return t})));i&&i.contentWindow&&(i.contentWindow.postMessage(u,"*"),n.type=e,n.resolve=r,n.reject=s)}))},e.prototype.setMapEventHandlers=function(e){this.mapEventHandlers=e?r(r({},this.mapEventHandlers),e):{}},e}(),o=function(){function e(e){this.iframe=document.createElement("iframe"),this._transport=new a(this.iframe,e),function(e,t){var n=t||{},i=n.id,r=void 0===i?"unfolded_iframe":i,a=n.appendToElement,o=n.appendToDocument,d=void 0===o||o,E=n.appendToId,p=void 0===E?null:E,T=n.embed,l=void 0!==T&&T,f=n.width,m=void 0===f?"100%":f,c=n.height,I=void 0===c?"100%":c,_=t.mapUUID?s(t.mapUUID):t.mapUrl;_||(_="https://studio.unfolded.ai/incognito"),l&&(_+="/embed"),e.setAttribute("src",_),e.setAttribute("id",r),e.setAttribute("width",""+m),e.setAttribute("height",""+I),e.style.width=u(m),e.style.height=u(I);var y=function(e,t,n){if(e||t){var i=e||(t?document.getElementById(t):null);if(i instanceof HTMLElement)return i}else if(n)return document.body}(a,p,d);if(y)!function(e,t,n){var i=e.querySelector&&e.querySelector("iframe#"+t);i?i.replaceWith(n):e.appendChild(n)}(y,r,e);else if(d)throw new Error("Target container element not found")}(this.iframe,e)}return e.prototype.sendMessage=function(e,t){return this._transport.sendMessage(e,t)},e.prototype.setMapEventHandlers=function(e){this._transport.setMapEventHandlers(e)},e.prototype.setViewState=function(e){return this.sendMessage(i.SET_VIEW_STATE,{viewState:e})},e.prototype.getLayers=function(){return this.sendMessage(i.GET_LAYERS,{})},e.prototype.setLayerVisibility=function(e,t){return this.sendMessage(i.SET_LAYER_VISIBILITY,{layerId:e,isVisible:t})},e.prototype.setTheme=function(e){return this.sendMessage(i.SET_THEME,{theme:e})},e.prototype.getTimelineInfo=function(e){return this.sendMessage(i.GET_TIMELINE_INFO,{idx:e})},e.prototype.setTimelineConfig=function(e){return this.sendMessage(i.SET_TIMELINE_CONFIG,{config:e})},e.prototype.refreshMapData=function(){return this.sendMessage(i.REFRESH_MAP_DATA,{})},e.prototype.getLayerTimelineInfo=function(){return this.sendMessage(i.GET_LAYER_TIMELINE_INFO,{})},e.prototype.setLayerTimelineConfig=function(e){return this.sendMessage(i.SET_LAYER_TIMELINE_CONFIG,{config:e})},e.prototype.setMapControlVisibility=function(e){return this.sendMessage(i.SET_MAP_CONTROL_VISIBILITY,{config:e})},e.prototype._addTileset=function(e){return this.sendMessage(i.ADD_TILESET_TO_MAP,{tileset:e})},e.prototype.addDataset=function(e,t){return void 0===t&&(t=!0),this.sendMessage(i.ADD_DATASET_TO_MAP,{dataset:"string"==typeof e?{uuid:e}:e,autoCreateLayers:t}).then((function(e){return e&&"ok"===e.status}))},e.prototype.removeDataset=function(e){return this.sendMessage(i.REMOVE_DATASET_FROM_MAP,{uuid:e}).then((function(e){return e&&"ok"===e.status}))},e.prototype.addLayer=function(e){return this.sendMessage(i.ADD_LAYER,e).then((function(e){return e&&"ok"===e.status}))},e.prototype.removeLayer=function(e){return this.sendMessage(i.REMOVE_LAYER,{id:e}).then((function(e){return e&&"ok"===e.status}))},e.prototype.setFilter=function(e){return this.sendMessage(i.SET_FILTER,{info:e}).then((function(e){return e&&"ok"===e.status}))},e.prototype.removeFilter=function(e){return this.sendMessage(i.REMOVE_FILTER,{id:e}).then((function(e){return e&&"ok"===e.status}))},e}();function u(e){return"number"==typeof e?e+"px":e}function d(e){return new o(e)}function E(e,t){return e.setViewState(t)}function p(e){return e.getLayers()}function T(e,t,n){return e.setLayerVisibility(t,n)}function l(e,t){return e.setTheme(t)}function f(e,t){return e.getTimelineInfo(t)}function m(e,t){return e.sendMessage(i.TOGGLE_TIMELINE_ANIMATION,{idx:t})}function c(e,t){return e.sendMessage(i.TOGGLE_TIMELINE_VISIBILITY,{idx:t})}function I(e,t,n,r){return e.sendMessage(i.SET_TIMELINE_INTERVAL,{idx:t,startTime:n,endTime:r})}function _(e,t,n){return e.sendMessage(i.SET_TIMELINE_SPEED,{idx:t,speed:n})}function y(e,t){return e.setTimelineConfig(t)}function L(e){return e.refreshMapData()}function M(e){return e.getLayerTimelineInfo()}function g(e,t){return e.setLayerTimelineConfig(t)}function h(e,t){return e.setMapControlVisibility(t)}function A(e,t){return e._addTileset(t)}function v(e,t){return e.addDataset(t)}function N(e,t){return e.removeDataset(t)}function S(e,t){return e.addLayer(t)}function k(e,t){return e.removeLayer(t)}function D(e,t){return e.setFilter(t)}function O(e,t){return e.removeFilter(t)}}}]);